# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –∑–∞–Ω—è—Ç–∏—é ¬´–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ—â–Ω–æ—Å—Ç–∏. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏¬ª  

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–¥–∞–Ω–∏—è

1. –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ Yandex Cloud, –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –≤ AWS (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ –∂–µ–ª–∞–Ω–∏—é). 
2. –í—Å–µ –¥–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –≤ –±–ª–æ–∫–µ 15 —Å–≤—è–∑–∞–Ω—ã –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –∏ –≤ –∫–æ–Ω—Ü–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –ø—Ä–∏–º–µ—Ä –∑–∞–∫–æ–Ω—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.  
3. –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é Terraform. –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –±—É–¥–µ—Ç –∫–æ–¥ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. 
4. –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –æ–±–ª–∞—á–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º –∏–∑ Terraform, –∏—Å–ø–æ–ª—å–∑—É—è –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–æ—à–ª—ã—Ö –ª–µ–∫—Ü–∏–π –∏ –¥–æ–º–∞—à–Ω–∏—Ö –∑–∞–¥–∞–Ω–∏–π.

---
## –ó–∞–¥–∞–Ω–∏–µ 1. Yandex Cloud 

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å**

1. –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç Object Storage –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ –Ω—ë–º —Ñ–∞–π–ª —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π:

 - –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç –≤ Object Storage —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, _–∏–º—è_—Å—Ç—É–¥–µ–Ω—Ç–∞_–¥–∞—Ç–∞_).
 - –ü–æ–ª–æ–∂–∏—Ç—å –≤ –±–∞–∫–µ—Ç —Ñ–∞–π–ª —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π.
 - –°–¥–µ–ª–∞—Ç—å —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.
 
2. –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É –í–ú –≤ public –ø–æ–¥—Å–µ—Ç–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å —à–∞–±–ª–æ–Ω–æ–º LAMP –∏ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ–π, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–∑ –±–∞–∫–µ—Ç–∞:

 - –°–æ–∑–¥–∞—Ç—å Instance Group —Å —Ç—Ä–µ–º—è –í–ú –∏ —à–∞–±–ª–æ–Ω–æ–º LAMP. –î–ª—è LAMP —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `image_id = fd827b91d99psvq5fjit`.
 - –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª `user_data` –≤ [meta_data](https://cloud.yandex.ru/docs/compute/concepts/vm-metadata).
 - –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ —à–∞–±–ª–æ–Ω–Ω–æ–π –í–ú —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–∑ –±–∞–∫–µ—Ç–∞.
 - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è –í–ú.
 
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –≥—Ä—É–ø–ø—É –∫ —Å–µ—Ç–µ–≤–æ–º—É –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫—É:

 - –°–æ–∑–¥–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫.
 - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, —É–¥–∞–ª–∏–≤ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –í–ú.
4. (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)* –°–æ–∑–¥–∞—Ç—å Application Load Balancer —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Instance group –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è.

–ü–æ–ª–µ–∑–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:

- [Compute instance group](https://registry.terraform.io/providers/yandex-cloud/yandex/latest/docs/resources/compute_instance_group).
- [Network Load Balancer](https://registry.terraform.io/providers/yandex-cloud/yandex/latest/docs/resources/lb_network_load_balancer).
- [–ì—Ä—É–ø–ø–∞ –í–ú —Å —Å–µ—Ç–µ–≤—ã–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–º](https://cloud.yandex.ru/docs/compute/operations/instance-groups/create-with-balancer).

---
### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
–°–æ–≥–ª–∞—Å–Ω–æ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é —Å–æ–∑–¥–∞—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é terraform –≤ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–∑–º–µ—â–∞—é –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
–ü—Ä–æ–≤–∞–π–¥–µ—Ä
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/providers.tf
—Å–æ–∑–¥–∞–Ω–∏–µ –ë–∞–∫–µ—Ç–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –Ω–µ–≥–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/bucket.tf
–°–æ–∑–¥–∞–Ω–∏–µ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–æ–ª–∏
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/service-account.tf
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/variables.tf
–°–µ—Ç—å
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/network.tf
–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å Lamp
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/instance-group.tf
–¢–∞—Ä–≥–µ—Ç –≥—Ä—É–ø–ø–∞ 
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/target-group.tf
–ë–∞–ª–∞–Ω—Å–µ—Ä
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/nlb.tf
–°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π–≥—Ä—É–ø–ø—ã Network Load Balancer
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/alb.tf
–í—ã–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∏ –±–∞–ª–∞–Ω—Å–µ—Ä–∞ 
https://github.com/ekhristin/netology/blob/main/CLOUD_HW_02/Terraform/outputs.tf

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ –∞ –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –Ω–∞–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–∞–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ–π –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —á–µ–º —Ä–æ–ª—å **editor**, –ø–æ —ç—Ç–æ–º—É –ø–æ–≤—ã—à–∞–µ–º —Ä–æ–ª—å **admin**
–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º—É —Å–µ—Ä–≤–∏—Å–Ω–æ–º—É –∞–∫–∞—É–Ω—Ç—É 
```
yc resource-manager folder add-access-binding my-test --role admin --subject serviceAccount:ajefqh*************

```

–∑–∞–ø—É—Å–∫–∞–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
![](Pasted%20image%2020251014170806.png)
![](Pasted%20image%2020251014170647.png)
###–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
–ü—Ä–æ–≤–µ—Ä—è—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –±–∞–∫–µ—Ç–µ ![](Pasted%20image%2020251014171120.png)
–ü—Ä–æ–≤–µ—Ä—è—é —á—Ç–æ —Å–æ–∑–¥–∞–ª–∞—Å—å –≥—Ä—É–ø–ø–∞ –¥–ª—è —Ç—Ä–µ—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
![](Pasted%20image%2020251014172107.png)
![](Pasted%20image%2020251014172142.png)
–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ø–∏—Å–∞–ª —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ 
```
#!/bin/bash

  

# –°–ø–∏—Å–æ–∫ IP –∞–¥—Ä–µ—Å–æ–≤ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

INSTANCES=("46.21.246.17" "51.250.80.5" "89.169.159.96")

# IP –∞–¥—Ä–µ—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

BALANCER_IP="130.193.35.20"

  

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞

GREEN='\033[0;32m'

RED='\033[0;31m'

YELLOW='\033[1;33m'

BLUE='\033[0;34m'

CYAN='\033[0;36m'

NC='\033[0m' # No Color

  

echo -e "${BLUE}=== –ü–†–û–í–ï–†–ö–ê –ò–ù–°–¢–ê–ù–°–û–í INSTANCE GROUP ===${NC}"

echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤: ${#INSTANCES[@]}"

echo "–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫: $BALANCER_IP"

echo ""

  

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–¥–Ω–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞

check_instance() {

local ip=$1

local instance_num=$2

echo -e "${YELLOW}üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Å—Ç–∞–Ω—Å–∞ ${instance_num}: ${ip}${NC}"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ HTTP

echo -n " HTTP –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: "

if curl -s -f --max-time 5 "http://${ip}/" > /dev/null; then

echo -e "${GREEN}‚úì –î–û–°–¢–£–ü–ï–ù${NC}"

else

echo -e "${RED}‚úó –ù–ï–î–û–°–¢–£–ü–ï–ù${NC}"

return 1

fi

# –ü–æ–ª—É—á–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

CONTENT=$(curl -s --max-time 5 "http://${ip}/")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

echo -n " –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: "

if echo "$CONTENT" | grep -q "Hello from LAMP"; then

echo -e "${GREEN}‚úì LAMP —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞${NC}"

else

echo -e "${YELLOW}‚ö† –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ${NC}"

fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

echo -n " –ù–∞–ª–∏—á–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏: "

IMAGE_URL=$(echo "$CONTENT" | grep -oP "src='[^']*'" | sed "s/src='//g" | sed "s/'//g")

if [ -n "$IMAGE_URL" ]; then

echo -e "${GREEN}‚úì –ö–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–∞–π–¥–µ–Ω–∞${NC}"

echo -e " URL –∫–∞—Ä—Ç–∏–Ω–∫–∏: ${CYAN}${IMAGE_URL}${NC}"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏

echo -n " –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏: "

if curl -s -f --max-time 5 -I "$IMAGE_URL" | grep -q "200"; then

echo -e "${GREEN}‚úì –î–û–°–¢–£–ü–ù–ê${NC}"

else

echo -e "${RED}‚úó –ù–ï–î–û–°–¢–£–ü–ù–ê${NC}"

fi

else

echo -e "${RED}‚úó –ö–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞${NC}"

fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞

echo -n " –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: "

RESPONSE_TIME=$(curl -s -w "%{time_total}s" -o /dev/null --max-time 5 "http://${ip}/")

echo -e "${BLUE}${RESPONSE_TIME}${NC}"

echo ""

}

  

# –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

check_balancer() {

echo -e "${BLUE}=== –ü–†–û–í–ï–†–ö–ê –ë–ê–õ–ê–ù–°–ò–†–û–í–©–ò–ö–ê ===${NC}"

echo -e "${YELLOW}–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫: ${BALANCER_IP}${NC}"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

echo -n "HTTP –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: "

if curl -s -f --max-time 5 "http://${BALANCER_IP}/" > /dev/null; then

echo -e "${GREEN}‚úì –î–û–°–¢–£–ü–ï–ù${NC}"

else

echo -e "${RED}‚úó –ù–ï–î–û–°–¢–£–ü–ï–ù${NC}"

return 1

fi

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

echo ""

echo -e "${YELLOW}–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (15 –∑–∞–ø—Ä–æ—Å–æ–≤):${NC}"

declare -A ip_distribution

for i in {1..15}; do

# –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

RESPONSE=$(curl -s --max-time 3 "http://${BALANCER_IP}/")

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å –∫–∞–∫–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞ –ø—Ä–∏—à–µ–ª –æ—Ç–≤–µ—Ç –ø–æ IP –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö

# –∏–ª–∏ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É (–µ—Å–ª–∏ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–∏—è)

BACKEND_IP="unknown"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

if echo "$RESPONSE" | grep -q "Hello from LAMP"; then

BACKEND_IP="lamp_instance"

fi

((ip_distribution["$BACKEND_IP"]++))

echo -e "–ó–∞–ø—Ä–æ—Å ${i}: ${GREEN}${BACKEND_IP}${NC}"

sleep 0.5

done

echo ""

echo -e "${BLUE}=== –°–¢–ê–¢–ò–°–¢–ò–ö–ê –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø ===${NC}"

for ip in "${!ip_distribution[@]}"; do

count=${ip_distribution[$ip]}

percentage=$((count * 100 / 15))

echo -e " ${ip}: ${count} –∑–∞–ø—Ä–æ—Å–æ–≤ (${percentage}%)"

done

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫

echo ""

echo -e "${YELLOW}–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —á–µ—Ä–µ–∑ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫:${NC}"

BALANCER_CONTENT=$(curl -s --max-time 5 "http://${BALANCER_IP}/")

BALANCER_IMAGE_URL=$(echo "$BALANCER_CONTENT" | grep -oP "src='[^']*'" | sed "s/src='//g" | sed "s/'//g")

if [ -n "$BALANCER_IMAGE_URL" ]; then

echo -e " URL –∫–∞—Ä—Ç–∏–Ω–∫–∏: ${CYAN}${BALANCER_IMAGE_URL}${NC}"

echo -n " –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: "

if curl -s -f --max-time 5 -I "$BALANCER_IMAGE_URL" | grep -q "200"; then

echo -e "${GREEN}‚úì –î–û–°–¢–£–ü–ù–ê${NC}"

else

echo -e "${RED}‚úó –ù–ï–î–û–°–¢–£–ü–ù–ê${NC}"

fi

fi

echo ""

}

  

# –§—É–Ω–∫—Ü–∏—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤

compare_responses() {

echo -e "${BLUE}=== –°–†–ê–í–ù–ï–ù–ò–ï –û–¢–í–ï–¢–û–í –ò–ù–°–¢–ê–ù–°–û–í ===${NC}"

declare -A responses

for ip in "${INSTANCES[@]}"; do

echo -n "–ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç ${ip}: "

RESPONSE=$(curl -s --max-time 3 "http://${ip}/" | head -c 100)

if [ -n "$RESPONSE" ]; then

responses["$ip"]="$RESPONSE"

echo -e "${GREEN}‚úì${NC}"

else

echo -e "${RED}‚úó${NC}"

fi

done

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤

echo ""

echo -n "–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤: "

UNIQUE_RESPONSES=$(printf "%s\n" "${responses[@]}" | sort -u | wc -l)

if [ "$UNIQUE_RESPONSES" -eq 1 ]; then

echo -e "${GREEN}‚úì –í—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç${NC}"

else

echo -e "${YELLOW}‚ö† –û—Ç–≤–µ—Ç—ã —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏${NC}"

fi

}

  

# –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

main() {

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—Ç–∏–ª–∏—Ç

if ! command -v curl &> /dev/null; then

echo -e "${RED}–û—à–∏–±–∫–∞: curl –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω${NC}"

exit 1

fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π –∏–Ω—Å—Ç–∞–Ω—Å

INSTANCE_NUM=1

for ip in "${INSTANCES[@]}"; do

check_instance "$ip" "$INSTANCE_NUM"

((INSTANCE_NUM++))

done

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫

check_balancer

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã

compare_responses

# –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

echo -e "${BLUE}=== –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===${NC}"

echo "–í—Å–µ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤: ${#INSTANCES[@]}"

echo "–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫: $BALANCER_IP"

echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(date)"

# –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

echo ""

echo -e "${CYAN}=== –î–õ–Ø –†–£–ß–ù–û–ô –ü–†–û–í–ï–†–ö–ò ===${NC}"

echo "curl http://$BALANCER_IP/"

echo "curl http://${INSTANCES[0]}/"

echo "curl -I 'https://khristin-111025.storage.yandexcloud.net/image.jpg'"

}

  

# –ó–∞–ø—É—Å–∫ –≥–ª–∞–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

main
```
–∑–∞–ø—É—Å–∫–∞—é —Å–∫—Ä–∏–ø—Ç
![](Pasted%20image%2020251014175703.png)
–¢–µ—Å—Ç–∏—Ä—É—é –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å
![](Pasted%20image%2020251014180355.png)
–ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—é —Å–∫—Ä–∏–ø—Ç 
![](Pasted%20image%2020251014180515.png)
–≤–∏–¥–Ω–æ —á—Ç–æ –≤—ã–∫–ª—é—á–µ–Ω–Ω–∞—è –∏–Ω—Å—Ç–∞–Ω—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
–∏ —á—Ç–æ —ç—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–ª–æ –Ω–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∞
![](Pasted%20image%2020251014180636.png)
![](Pasted%20image%2020251014180736.png)
### –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏—ë–º–∞ —Ä–∞–±–æ—Ç—ã

–î–æ–º–∞—à–Ω—è—è —Ä–∞–±–æ—Ç–∞ –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –≤ —Å–≤–æ—ë–º Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ —Ñ–∞–π–ª–µ README.md. –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø—Ä–∏—à–ª–∏—Ç–µ —Å—Å—ã–ª–∫–æ–π –Ω–∞ .md-—Ñ–∞–π–ª –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
–§–∞–π–ª README.md –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤—ã–≤–æ–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–º–∞–Ω–¥, –∞ —Ç–∞–∫–∂–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–∫—Å—Ç—ã –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ –∏–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–∏—Ö –≤ —Ñ–∞–π–ª–µ README.md.
